function y=s_curve(t1,J,am,scurve_param,t,T)
t2=scurve_param(1);t3=scurve_param(2);Vm=scurve_param(3);

y=    (1/6*J*t.^3).*(t>=0&t<t1)...
    + (1/6*J*t1.^3 + 1/2*J*t1.^2*(t-t1) + 1/2*am*(t-t1).^2).*(t>=t1&t<t2)...
    + (1/6*J*t1.^3 + 1/2*J*t1.^2*(t2-t1) + 1/2*am*(t2-t1).^2    +   (1/2*J*t1^2+am*(t2-t1))*(t-t2)  -  1/6*J*(t-t2).^3 + 1/2*am*(t-t2).^2 ).*(t>=t2&t<t3)...
    + (1/6*J*t1.^3 + 1/2*J*t1.^2*(t2-t1) + 1/2*am*(t2-t1).^2    +   (1/2*J*t1^2+am*(t2-t1))*(t3-t2)  -  1/6*J*(t3-t2).^3 + 1/2*am*(t3-t2).^2   +    Vm*(t-t3)).*(t>=t3&t<T/2)...
    + (L-s_curve_half(t1,J,am,scurve_param,t,T)).*(t>=T/2);
end
